name: ğŸ”’ G Drive Field Standard Enforcement
on: [push, pull_request]

jobs:
  verify-field-standard:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    
    - name: ğŸ” Check for banned old field names
      run: |
        echo "ğŸ” Scanning for old field names..."
        
        # Check for banned patterns
        BANNED_PATTERNS="itemId|descr|qStk|moStat|bomItem|buildItem|mohId|poStatus|pohId|name|ordered|received|cumCost|totMatCost|priority|dueDate|startDate|endDate|closeDt|ordDt|wipQty|endQty|customer|vendor"
        
        if grep -r "\.\($BANNED_PATTERNS\)" frontend/src/components/; then
          echo "âŒ CRITICAL ERROR: Banned old field names detected!"
          echo "âŒ This violates the G: Drive Field Standard"
          echo "âŒ See G_DRIVE_FIELD_STANDARD.md for correct field names"
          exit 1
        else
          echo "âœ… PASS: No banned field names found"
        fi
    
    - name: âœ… Verify G Drive field usage
      run: |
        echo "âœ… Checking for proper G: Drive field usage..."
        
        # Check for bracket notation usage
        if grep -r "\[\"[^\"]*\"\]" frontend/src/components/ | head -5; then
          echo "âœ… PASS: Found G: Drive bracket notation usage"
        else
          echo "âŒ WARNING: No G: Drive bracket notation found"
        fi
        
        # Check for proper file names
        if grep -r "data\[.*\.json.*\]" frontend/src/components/ | head -5; then
          echo "âœ… PASS: Found proper .json file references"
        else
          echo "âŒ WARNING: No .json file references found"
        fi
    
    - name: ğŸ¯ Standard verification complete
      run: |
        echo "ğŸ¯ G: Drive Field Standard verification completed successfully"
        echo "âœ… System is compliant with field naming requirements"
