[2026-02-05 19:50:09 +0000] [7] [INFO] 10.23.7.5:43266 - - [05/Feb/2026:19:50:09 +0000] "OPTIONS /api/pr/create-from-bom 1.1" 200 1 "https://canoil-portal.vercel.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"
================================================================================
ðŸ”„ BOM-BASED PR GENERATION
================================================================================
User: Haron A
Department: Sales
Justification: For Laser order with PO022356
Selected Items: 2
  - LZ 2T SEMI-SYN BL 24X3.4 x 240
  - LZ 2T SEMI-SYN BL 6X946 x 320
================================================================================
ðŸ“¦ Step 1: Exploding BOMs...
[PR] â˜ï¸ Render: Loading BillOfMaterialDetails.json via Google Drive API
[INFO] Attempt 1/3 to list shared drives
[INFO] Searching for shared drive 'IT_Automation' among 4 drives
[INFO] Available shared drives:
   - IT_Automation (ID: 0AM5YTKFJmMBKUk9PVA)
   - MPS / Shipments  (ID: 0AMATkJyvydcLUk9PVA)
   - RnD_Technical  (ID: 0ADpHVFqlBzaNUk9PVA)
   - Sales_CSR (ID: 0AMwceUKIC3FhUk9PVA)
[OK] Found shared drive: IT_Automation (ID: 0AM5YTKFJmMBKUk9PVA)
[OK] Found folder: MiSys (ID: 1lZIbNTx4GNFW6BSY9Ms4GfmQpQ5shtcA)
[OK] Found folder: Misys Extracted Data (ID: 1I_yyl9SFoIopzIJxLp9H_-OX3NZ7hV0C)
[OK] Found folder: API Extractions (ID: 1QJFNUow9HaX0MLfNCgYEu187MtO7FXoh)
[OK] Found base folder 'MiSys/Misys Extracted Data/API Extractions' (ID: 1QJFNUow9HaX0MLfNCgYEu187MtO7FXoh)
[OK] Latest folder: 2026-02-05 (ID: 1G6VPHx89RE9O_-oVNYz_nZkxVvZ4DpCs)
[INFO] Downloading: BillOfMaterialDetails.json
[PR] âœ… Loaded BillOfMaterialDetails.json: 3864
[PR] â˜ï¸ Render: Loading Items.json via Google Drive API
[INFO] Attempt 1/3 to list shared drives
[INFO] Searching for shared drive 'IT_Automation' among 4 drives
[INFO] Available shared drives:
   - IT_Automation (ID: 0AM5YTKFJmMBKUk9PVA)
   - MPS / Shipments  (ID: 0AMATkJyvydcLUk9PVA)
   - RnD_Technical  (ID: 0ADpHVFqlBzaNUk9PVA)
   - Sales_CSR (ID: 0AMwceUKIC3FhUk9PVA)
[OK] Found shared drive: IT_Automation (ID: 0AM5YTKFJmMBKUk9PVA)
[OK] Found folder: MiSys (ID: 1lZIbNTx4GNFW6BSY9Ms4GfmQpQ5shtcA)
[OK] Found folder: Misys Extracted Data (ID: 1I_yyl9SFoIopzIJxLp9H_-OX3NZ7hV0C)
[OK] Found folder: API Extractions (ID: 1QJFNUow9HaX0MLfNCgYEu187MtO7FXoh)
[OK] Found base folder 'MiSys/Misys Extracted Data/API Extractions' (ID: 1QJFNUow9HaX0MLfNCgYEu187MtO7FXoh)
[OK] Latest folder: 2026-02-05 (ID: 1G6VPHx89RE9O_-oVNYz_nZkxVvZ4DpCs)
[INFO] Downloading: Items.json
[PR] âœ… Loaded Items.json: 2642
âœ… Loaded BOM data: 3864 lines, Items: 2642 items
  Exploding: LZ 2T SEMI-SYN BL 24X3.4 (Qty: 240.0)
[PR] Using cached data for BillOfMaterialDetails.json
[PR] â˜ï¸ Render: Loading CustomAlert5.json via Google Drive API
[INFO] Attempt 1/3 to list shared drives
[INFO] Searching for shared drive 'IT_Automation' among 4 drives
[INFO] Available shared drives:
   - IT_Automation (ID: 0AM5YTKFJmMBKUk9PVA)
   - MPS / Shipments  (ID: 0AMATkJyvydcLUk9PVA)
   - RnD_Technical  (ID: 0ADpHVFqlBzaNUk9PVA)
   - Sales_CSR (ID: 0AMwceUKIC3FhUk9PVA)
[OK] Found shared drive: IT_Automation (ID: 0AM5YTKFJmMBKUk9PVA)
[OK] Found folder: MiSys (ID: 1lZIbNTx4GNFW6BSY9Ms4GfmQpQ5shtcA)
[OK] Found folder: Misys Extracted Data (ID: 1I_yyl9SFoIopzIJxLp9H_-OX3NZ7hV0C)
[OK] Found folder: API Extractions (ID: 1QJFNUow9HaX0MLfNCgYEu187MtO7FXoh)
[OK] Found base folder 'MiSys/Misys Extracted Data/API Extractions' (ID: 1QJFNUow9HaX0MLfNCgYEu187MtO7FXoh)
[OK] Latest folder: 2026-02-05 (ID: 1G6VPHx89RE9O_-oVNYz_nZkxVvZ4DpCs)
[INFO] Downloading: CustomAlert5.json
[PR] âœ… Loaded CustomAlert5.json: 1961
    ðŸ“‹ Using BOM Revision 0 for: LZ 2T SEMI-SYN BL 24X3.4
[PR] Using cached data for Items.json
    ðŸ“¦ Exploding formula: CC 2T SEMI SYN FRMULA-1L (qty: 576.0)
[PR] Using cached data for BillOfMaterialDetails.json
[PR] Using cached data for CustomAlert5.json
    ðŸ“‹ Using BOM Revision 1 for: CC 2T SEMI SYN FRMULA-1L
[PR] Using cached data for Items.json
[PR] Using cached data for Items.json
[PR] Using cached data for Items.json
[PR] Using cached data for Items.json
[PR] Using cached data for Items.json
[PR] Using cached data for Items.json
[PR] Using cached data for Items.json
[PR] Using cached data for Items.json
[PR] Using cached data for Items.json
    â†’ Found 9 purchasable components
  Exploding: LZ 2T SEMI-SYN BL 6X946 (Qty: 320.0)
[PR] Using cached data for BillOfMaterialDetails.json
[PR] Using cached data for CustomAlert5.json
    ðŸ“‹ Using BOM Revision 0 for: LZ 2T SEMI-SYN BL 6X946
[PR] Using cached data for Items.json
    ðŸ“¦ Exploding formula: CC 2T SEMI SYN FRMULA-1L (qty: 1920.0)
[PR] Using cached data for BillOfMaterialDetails.json
[PR] Using cached data for CustomAlert5.json
    ðŸ“‹ Using BOM Revision 1 for: CC 2T SEMI SYN FRMULA-1L
[PR] Using cached data for Items.json
[PR] Using cached data for Items.json
[PR] Using cached data for Items.json
[PR] Using cached data for Items.json
[PR] Using cached data for Items.json
[PR] Using cached data for Items.json
[PR] Using cached data for Items.json
[PR] Using cached data for Items.json
[PR] Using cached data for Items.json
    â†’ Found 9 purchasable components
  Total raw components: 18
ðŸ“¦ Step 2: Aggregating components...
  Unique components after aggregation: 14
ðŸ“¦ Step 3: Checking stock levels...
[PR] Using cached data for CustomAlert5.json
  âœ… OK: PC VHVI-8 TOTE | Need: 380.09 | Have: 2080.0
[PR] Using cached data for CustomAlert5.json
  âœ… OK: OLOA 9362 DRUM | Need: 124.8 | Have: 669.09
[PR] Using cached data for CustomAlert5.json
  âœ… OK: BLUE FLUSH OIL TYPE-F | Need: 2021.76 | Have: 3448.5
[PR] Using cached data for CustomAlert5.json
  âœ… OK: CC 100ML BLACK BOTTLE | Need: 5760.0 | Have: 45153.0
[PR] Using cached data for CustomAlert5.json
  âœ… OK: CC RED CAP 28-400 | Need: 7680.0 | Have: 49977.0
[PR] Using cached data for CustomAlert5.json
  âœ… OK: CC CTN 24X3.4OZ CARTON | Need: 240.0 | Have: 3000.0
[PR] Using cached data for CustomAlert5.json
  âœ… OK: LZ 2T SSB 24X3.4OZ LBL-F | Need: 5760.0 | Have: 6500.0
[PR] Using cached data for CustomAlert5.json
  âœ… OK: LZ 2T SSB 24X3.4OZ LBL-B | Need: 5760.0 | Have: 6500.0
[PR] Using cached data for CustomAlert5.json
  âœ… OK: LZ 2T SSB 24X3.4 BOX LBL | Need: 240.0 | Have: 550.0
[PR] Using cached data for CustomAlert5.json
  âœ… OK: CC 1L BLACK BOTTLE | Need: 1920.0 | Have: 29180.0
[PR] Using cached data for CustomAlert5.json
[PR] â˜ï¸ Render: Loading PurchaseOrderDetails.json via Google Drive API
[INFO] Attempt 1/3 to list shared drives
[INFO] Searching for shared drive 'IT_Automation' among 4 drives
[INFO] Available shared drives:
   - IT_Automation (ID: 0AM5YTKFJmMBKUk9PVA)
   - MPS / Shipments  (ID: 0AMATkJyvydcLUk9PVA)
   - RnD_Technical  (ID: 0ADpHVFqlBzaNUk9PVA)
   - Sales_CSR (ID: 0AMwceUKIC3FhUk9PVA)
[OK] Found shared drive: IT_Automation (ID: 0AM5YTKFJmMBKUk9PVA)
[OK] Found folder: MiSys (ID: 1lZIbNTx4GNFW6BSY9Ms4GfmQpQ5shtcA)
[OK] Found folder: Misys Extracted Data (ID: 1I_yyl9SFoIopzIJxLp9H_-OX3NZ7hV0C)
[OK] Found folder: API Extractions (ID: 1QJFNUow9HaX0MLfNCgYEu187MtO7FXoh)
[OK] Found base folder 'MiSys/Misys Extracted Data/API Extractions' (ID: 1QJFNUow9HaX0MLfNCgYEu187MtO7FXoh)
[OK] Latest folder: 2026-02-05 (ID: 1G6VPHx89RE9O_-oVNYz_nZkxVvZ4DpCs)
[INFO] Downloading: PurchaseOrderDetails.json
[PR] âœ… Loaded PurchaseOrderDetails.json: 7812
[PR] â˜ï¸ Render: Loading PurchaseOrders.json via Google Drive API
[INFO] Attempt 1/3 to list shared drives
[INFO] Searching for shared drive 'IT_Automation' among 4 drives
[INFO] Available shared drives:
   - IT_Automation (ID: 0AM5YTKFJmMBKUk9PVA)
   - MPS / Shipments  (ID: 0AMATkJyvydcLUk9PVA)
   - RnD_Technical  (ID: 0ADpHVFqlBzaNUk9PVA)
   - Sales_CSR (ID: 0AMwceUKIC3FhUk9PVA)
[OK] Found shared drive: IT_Automation (ID: 0AM5YTKFJmMBKUk9PVA)
[OK] Found folder: MiSys (ID: 1lZIbNTx4GNFW6BSY9Ms4GfmQpQ5shtcA)
[OK] Found folder: Misys Extracted Data (ID: 1I_yyl9SFoIopzIJxLp9H_-OX3NZ7hV0C)
[OK] Found folder: API Extractions (ID: 1QJFNUow9HaX0MLfNCgYEu187MtO7FXoh)
[OK] Found base folder 'MiSys/Misys Extracted Data/API Extractions' (ID: 1QJFNUow9HaX0MLfNCgYEu187MtO7FXoh)
[OK] Latest folder: 2026-02-05 (ID: 1G6VPHx89RE9O_-oVNYz_nZkxVvZ4DpCs)
[INFO] Downloading: PurchaseOrders.json
[PR] âœ… Loaded PurchaseOrders.json: 4195
  âš ï¸ SHORT: LZ 2T SSB 6X946 ML LBL F | Need: 1920.0 EA | Have: 470.0 | Order: 1450 EA
[PR] Using cached data for CustomAlert5.json
[PR] Using cached data for PurchaseOrderDetails.json
[PR] Using cached data for PurchaseOrders.json
  âš ï¸ SHORT: LZ 2T SSB 6X946 ML LBL B | Need: 1920.0 EA | Have: 355.0 | Order: 1565 EA
[PR] Using cached data for CustomAlert5.json
[PR] Using cached data for PurchaseOrderDetails.json
[PR] Using cached data for PurchaseOrders.json
  âš ï¸ SHORT: LASER 1LX6PK | Need: 320.0 EA | Have: 131.0 | Order: 189 EA
[PR] Using cached data for CustomAlert5.json
  âœ… OK: LZ 2T SSB 6X946ML BOX LB | Need: 320.0 | Have: 408.0
ðŸ“¦ Step 4: Grouping by supplier...
  Suppliers found: 1
    - GERRITY: 1 items
  âš ï¸ Items without supplier: 2
ðŸ“¦ Step 5: Generating PR files...
  Creating PR for: GERRITY (1 items)
[PR] ðŸ“‹ Using manual override for GERRITY
[PR] Using cached data for PurchaseOrders.json
[PR] âœ… Found supplier info: Gerrity Corrugated Paper Products Ltd (4 POs)
[PR] â˜ï¸ Render: Loading PurchaseOrderAdditionalCostsTaxes.json via Google Drive API
[INFO] Attempt 1/3 to list shared drives
[INFO] Searching for shared drive 'IT_Automation' among 4 drives
[INFO] Available shared drives:
   - IT_Automation (ID: 0AM5YTKFJmMBKUk9PVA)
   - MPS / Shipments  (ID: 0AMATkJyvydcLUk9PVA)
   - RnD_Technical  (ID: 0ADpHVFqlBzaNUk9PVA)
   - Sales_CSR (ID: 0AMwceUKIC3FhUk9PVA)
[OK] Found shared drive: IT_Automation (ID: 0AM5YTKFJmMBKUk9PVA)
[OK] Found folder: MiSys (ID: 1lZIbNTx4GNFW6BSY9Ms4GfmQpQ5shtcA)
[OK] Found folder: Misys Extracted Data (ID: 1I_yyl9SFoIopzIJxLp9H_-OX3NZ7hV0C)
[OK] Found folder: API Extractions (ID: 1QJFNUow9HaX0MLfNCgYEu187MtO7FXoh)
[OK] Found base folder 'MiSys/Misys Extracted Data/API Extractions' (ID: 1QJFNUow9HaX0MLfNCgYEu187MtO7FXoh)
[OK] Latest folder: 2026-02-05 (ID: 1G6VPHx89RE9O_-oVNYz_nZkxVvZ4DpCs)
[INFO] Downloading: PurchaseOrderAdditionalCostsTaxes.json
[POST]
canoil-portal-1.onrender.com/api/pr/create-from-bom clientIP="67.208.31.167" requestID="13c68cec-2e4f-4734" responseTimeMS=31517 responseBytes=65453 userAgent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"
[GET]
canoil-portal-1.onrender.com/api/pr/history clientIP="67.208.31.167" requestID="1e40f13d-25b0-47dd" responseTimeMS=4 responseBytes=410 userAgent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"
[PR] âœ… Loaded PurchaseOrderAdditionalCostsTaxes.json: 50
[PR]   â„¹ï¸ No extended info in AdditionalCostsTaxes for GERRITY
[PR]   ðŸ“‹ Applied supplier data from supplier_contacts.json
    Supplier Name: Gerrity Corrugated Paper Products Ltd
[PR] ðŸ”„ Cleared cached values from 16 formula cells for recalculation
[PR] ðŸ”„ Set fullCalcOnLoad=1 in workbook.xml to force formula recalculation on open
[PR] âœ… Filled 109 cells directly - template 100% preserved
    âœ… Generated: PR_Laser_Gerrity_Corrugated_Paper_Produ_2026-02-05.xlsx
  Creating PR for items without supplier (2 items)
[PR] ðŸ”„ Cleared cached values from 16 formula cells for recalculation
[PR] ðŸ”„ Set fullCalcOnLoad=1 in workbook.xml to force formula recalculation on open
[PR] âœ… Filled 109 cells directly - template 100% preserved
    âœ… Generated: PR-2026-02-05-NO-SUPPLIER.xlsx (no supplier assigned)
ðŸ“¦ Step 5.5: Generating shortage report...
[PR] ðŸ“‹ Using manual override for GERRITY
[PR] Using cached data for PurchaseOrders.json
[PR] âœ… Found supplier info: Gerrity Corrugated Paper Products Ltd (4 POs)
[PR] Using cached data for PurchaseOrderAdditionalCostsTaxes.json
[PR]   â„¹ï¸ No extended info in AdditionalCostsTaxes for GERRITY
[PR]   ðŸ“‹ Applied supplier data from supplier_contacts.json
  âœ… Shortage report generated
ðŸ“‹ Step 5.6: Saving to PR history...
[PR] ðŸ“‹ Using manual override for GERRITY
[PR] Using cached data for PurchaseOrders.json
[PR] âœ… Found supplier info: Gerrity Corrugated Paper Products Ltd (4 POs)
[PR] Using cached data for PurchaseOrderAdditionalCostsTaxes.json
[PR]   â„¹ï¸ No extended info in AdditionalCostsTaxes for GERRITY
[PR]   ðŸ“‹ Applied supplier data from supplier_contacts.json
[PR] âœ… Added PR to history: PR-20260205-195041
  âœ… PR history saved: PR-20260205-195041
ðŸ“¦ Step 6: Returning 2 PR file(s)...
âœ… SUCCESS: Generated ZIP with 2 PRs
âš ï¸ Warnings: ['No preferred supplier for: LZ 2T SSB 6X946 ML LBL F - Please assign supplier manually', 'No preferred supplier for: LZ 2T SSB 6X946 ML LBL B - Please assign supplier manually']
[2026-02-05 19:50:41 +0000] [7] [INFO] 10.23.7.5:43266 - - [05/Feb/2026:19:50:41 +0000] "POST /api/pr/create-from-bom 1.1" 200 65011 "https://canoil-portal.vercel.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"
[2026-02-05 19:50:41 +0000] [7] [INFO] 10.23.7.5:43266 - - [05/Feb/2026:19:50:41 +0000] "GET /api/pr/history 1.1" 200 40 "https://canoil-portal.vercel.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"
==> Detected service running on port 10000
==> Docs on specifying a port: https://render.com/docs/web-services#port-binding
[GET]
canoil-portal-1.onrender.com/api/pr/history clientIP="67.208.31.167" requestID="c4407a4c-f8e4-4802" responseTimeMS=4 responseBytes=410 userAgent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"
[2026-02-05 19:52:22 +0000] [7] [INFO] 10.17.96.66:32834 - - [05/Feb/2026:19:52:22 +0000] "GET /api/pr/history 1.1" 200 40 "https://canoil-portal.vercel.app/" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/143.0.0.0 Safari/537.36"