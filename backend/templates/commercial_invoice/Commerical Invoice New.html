<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Commercial Invoice - Declaration by Foreign Shipper</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            font-size: 9px;
            line-height: 1.2;
            background: #f5f5f5;
            padding: 10px;
            color: #000;
        }
        
        .invoice-container {
            max-width: 850px;
            margin: 0 auto;
            background: white;
            padding: 15px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.1);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 0;
        }
        
        td {
            border: 1px solid #000;
            padding: 5px 6px;
            vertical-align: top;
        }
        
        .label {
            font-weight: bold;
            font-size: 7.5px;
            display: block;
            margin-bottom: 3px;
            text-transform: uppercase;
            letter-spacing: 0.2px;
        }
        
        input, textarea, select {
            width: 100%;
            border: none;
            padding: 2px;
            font-size: 10px;
            font-family: 'Arial', sans-serif;
            background: transparent;
            line-height: 1.3;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: 1px solid #4CAF50;
            background: #fffef0;
        }
        
        textarea {
            resize: vertical;
            overflow-y: hidden;
        }
        
        /* Item description textareas - fit content exactly */
        textarea.item-description {
            min-height: auto;
            padding: 2px 4px;
            line-height: 1.3;
        }
        
        .header-title {
            font-weight: bold;
            font-size: 11px;
            text-align: center;
            padding: 8px;
        }
        
        .checkbox-group {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
            margin-top: 3px;
        }
        
        .checkbox-group label {
            display: flex;
            align-items: center;
            gap: 4px;
            font-weight: normal;
            font-size: 9px;
        }
        
        .checkbox-group input[type="radio"],
        .checkbox-group input[type="checkbox"] {
            width: auto;
            margin: 0;
        }
        
        .items-header {
            background: #e8e8e8;
            font-weight: bold;
            text-align: center;
            font-size: 7.5px;
            padding: 4px;
        }
        
        .add-row-btn {
            background-color: #4CAF50;
            color: white;
            padding: 5px 12px;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            font-size: 9px;
            font-weight: bold;
            margin: 4px 0;
        }
        
        .total-row {
            background: #f0f0f0;
            font-weight: bold;
        }
        
        @media print {
            /* Hide scrollbars and prevent scrolling */
            html, body {
                overflow: hidden !important;
                height: 100% !important;
                background: white;
                padding: 0;
                margin: 0;
            }
            
            .invoice-container {
                box-shadow: none;
                padding: 10px;
                padding-bottom: 30px;
                max-width: 100%;
                overflow: visible !important;
            }
            
            /* Remove all scrollbars */
            * {
                overflow: visible !important;
                scrollbar-width: none !important;
                -ms-overflow-style: none !important;
            }
            
            *::-webkit-scrollbar {
                display: none !important;
                width: 0 !important;
                height: 0 !important;
            }
            
            /* Hide all interactive elements */
            .add-row-btn, .print-btn, button, .btn, [onclick] {
                display: none !important;
            }
            
            @page {
                margin: 0.4in;
                size: letter;
            }
            
            /* Make inputs look like plain text - no borders, no outlines */
            input[type="text"], 
            input[type="number"], 
            textarea, 
            select {
                border: none !important;
                outline: none !important;
                background: transparent !important;
                box-shadow: none !important;
                appearance: none !important;
                -webkit-appearance: none !important;
                -moz-appearance: none !important;
                resize: none !important;
                overflow: hidden !important;
                cursor: default !important;
            }
            
            /* Remove focus indicators */
            input:focus, textarea:focus, select:focus {
                outline: none !important;
                border: none !important;
                box-shadow: none !important;
            }
            
            /* Enhanced print clarity for photocopying */
            body, p, div, span, td, th, strong, label, input, textarea, select, .label {
                color: #000 !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            
            /* Solid black borders for clear photocopies (only on table cells) */
            table, td, th {
                border-color: #000 !important;
            }
            
            /* Ensure filled text is visible and black */
            input, textarea, select {
                color: #000 !important;
                opacity: 1 !important;
            }
            
            /* Slightly larger fonts for better clarity */
            body {
                font-size: 9.5px !important;
            }
            
            td, input, textarea, select {
                font-size: 10.5px !important;
            }
            
            .label {
                font-size: 8px !important;
                font-weight: bold !important;
            }
            
            .header-title {
                font-size: 12px !important;
                font-weight: bold !important;
            }
            
            .items-header {
                font-size: 8px !important;
                font-weight: bold !important;
            }
        }
    </style>
</head>
<body>
    <div class="invoice-container">
        <!-- Title -->
        <table>
            <tr>
                <td class="header-title" colspan="2">
                    COMBINATION: INVOICE - DECLARATION BY FOREIGN SHIPPER
                </td>
            </tr>
            <tr>
                <td style="width: 65%; padding: 8px;">
                    <!-- Empty space for INVOICE label -->
                </td>
                <td style="width: 35%; padding: 5px; font-size: 8px; line-height: 1.6;">
                    For Customs clearance send documents to:<br>
                    <input type="text" id="brokerCompany" style="width: 100%; border: none; border-bottom: 1px solid #000; font-weight: bold;"><br>
                    Phone: <input type="text" id="brokerPhone" style="width: 70%; border: none; border-bottom: 1px solid #000;"><br>
                    Fax: <input type="text" id="brokerFax" style="width: 70%; border: none; border-bottom: 1px solid #000;"><br>
                    PAPS: <input type="text" id="brokerPaps" style="width: 70%; border: none; border-bottom: 1px solid #000;">
                </td>
            </tr>
            <tr>
                <td style="padding: 5px;">
                    <span class="label">Shipment Reference#</span>
                    <input type="text" id="shipmentRef">
                </td>
                <td style="padding: 5px;">
                    <span class="label">Shipment Control#</span>
                    <input type="text" id="controlNum">
                </td>
            </tr>
        </table>
        
        <!-- Exporter and Producer -->
        <table>
            <tr>
                <td style="width: 50%;">
                    <span class="label">Exporter, Seller</span>
                    <input type="text" id="exporterName">
                    <textarea id="exporterAddress"></textarea>
                </td>
                <td style="width: 50%;">
                    <span class="label">Producer of Goods (if different than exporter)</span>
                    <textarea id="producerInfo"></textarea>
                </td>
            </tr>
        </table>
        
        <!-- Consignee and Buyer -->
        <table>
            <tr>
                <td style="width: 50%;">
                    <span class="label">Shipped To, Consignee</span>
                    <textarea id="consigneeInfo"></textarea>
                    <div style="margin-top: 5px; font-size: 8px;">
                        <strong>IRS NUMBER:</strong> 
                        <input type="text" id="irsNumber" style="width: 140px; border-bottom: 1px solid #000; display: inline;">
                    </div>
                </td>
                <td style="width: 50%;">
                    <span class="label">Buyer (if different than consignee)</span>
                    <textarea id="buyerInfo"></textarea>
                </td>
            </tr>
        </table>
        
        <!-- Transaction Details -->
        <table>
            <tr>
                <td style="width: 25%;">
                    <span class="label" style="font-size: 7px;">Parties to this transaction are</span>
                    <div class="checkbox-group" style="flex-direction: column; align-items: flex-start; gap: 3px;">
                        <label><input type="radio" name="related" value="related"> RELATED</label>
                        <label><input type="radio" name="related" value="not-related" checked> NOT RELATED</label>
                    </div>
                </td>
                <td style="width: 25%;">
                    <span class="label">Country of Final Dest.</span>
                    <input type="text" id="finalDestination">
                </td>
                <td style="width: 25%;">
                    <span class="label">Invoice Date</span>
                    <input type="date" id="invoiceDate">
                </td>
                <td style="width: 25%;">
                    <span class="label">Date of Sale</span>
                    <input type="date" id="saleDate">
                </td>
            </tr>
        </table>
        
        <!-- Duty and Terms -->
        <table>
            <tr>
                <td style="width: 50%;" rowspan="3">
                    <span class="label" style="font-size: 7px;">Duty / Brokerage for Account of:</span>
                    <div class="checkbox-group" style="flex-direction: column; align-items: flex-start; gap: 3px;">
                        <label><input type="radio" name="dutyAccount" value="exporter"> EXPORTER</label>
                        <label><input type="radio" name="dutyAccount" value="consignee" checked> SHIP TO, CONSIGNEE</label>
                        <label style="width: 100%;"><input type="radio" name="dutyAccount" value="other"> OTHER: <input type="text" id="dutyAccountOther" style="width: 120px; border-bottom: 1px solid #000;"></label>
                    </div>
                    <div style="margin-top: 6px; font-size: 8px;">
                        <strong>BROKERAGE:</strong>
                        <input type="text" id="brokerage" style="border-bottom: 1px solid #000; margin-top: 2px;">
                    </div>
                </td>
                <td style="width: 25%;">
                    <span class="label">Discounts</span>
                    <input type="text" id="discounts">
                </td>
                <td style="width: 25%;">
                    <span class="label">Port of Entry</span>
                    <input type="text" id="portOfEntry">
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <span class="label">Terms of Sale</span>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <select id="termsOfSale" onchange="toggleCustomTerms(this)">
                            <option value="">Select...</option>
                            <option value="DAP">DAP</option>
                            <option value="EXW">EXW</option>
                            <option value="FCA">FCA</option>
                            <option value="FOB">FOB</option>
                            <option value="CIF">CIF</option>
                            <option value="DDP">DDP</option>
                            <option value="CPT">CPT</option>
                            <option value="CFR">CFR</option>
                            <option value="other">Other...</option>
                        </select>
                        <input type="text" id="termsOfSaleCustom" placeholder="Type custom terms" style="display: none; width: 150px; border-bottom: 1px solid #000;">
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="2">
                    <span class="label">Currency of Sale</span>
                    <div class="checkbox-group">
                        <label><input type="radio" name="currency" value="USD" checked> U.S.</label>
                        <label><input type="radio" name="currency" value="CAD"> CANADIAN</label>
                        <label><input type="radio" name="currency" value="other"> OTHER: <input type="text" id="currencyOther" style="width: 70px; border-bottom: 1px solid #000;"></label>
                    </div>
                </td>
            </tr>
        </table>
        
        <!-- Shipping Details -->
        <table>
            <tr>
                <td style="width: 12%; padding: 5px;">
                    <span class="label" style="font-size: 7px;">Marks and Numbers</span>
                    <input type="text" id="marksNumbers">
                </td>
                <td style="width: 23%; padding: 5px;">
                    <span class="label" style="font-size: 7px;">Numbers and Kind of Packages</span>
                    <input type="text" id="packagesDescription">
                </td>
                <td style="width: 13%; padding: 5px;">
                    <span class="label" style="font-size: 7px;">Shipping Weight</span>
                    <input type="text" id="shippingWeight">
                </td>
                <td style="width: 26%; padding: 5px;">
                    <span class="label" style="font-size: 7px;">Freight Amount Included</span>
                    <input type="text" id="freightIncluded">
                </td>
                <td style="width: 26%; padding: 5px;">
                    <span class="label" style="font-size: 7px;">Freight Amount to Border</span>
                    <input type="text" id="freightToBorder">
                </td>
            </tr>
        </table>
        
        <!-- Items Table -->
        <button class="add-row-btn" onclick="addItemRow()">+ Add Item</button>
        <table id="itemsTable">
            <thead>
                <tr>
                    <td class="items-header" style="width: 10%;">COUNTRY<br>OF ORIGIN</td>
                    <td class="items-header" style="width: 32%;">DESCRIPTION OF GOODS</td>
                    <td class="items-header" style="width: 12%;">TEN DIGIT<br>H.T.S. NUMBER</td>
                    <td class="items-header" style="width: 10%;">UNIT QTY</td>
                    <td class="items-header" style="width: 12%;">UNIT PRICE</td>
                    <td class="items-header" style="width: 14%;">INVOICE TOTAL</td>
                </tr>
            </thead>
            <tbody id="itemsBody">
                <tr>
                    <td><input type="text" class="country-origin"></td>
                    <td><textarea class="item-description" rows="1"></textarea></td>
                    <td><input type="text" class="hts-code"></td>
                    <td><input type="number" class="unit-qty" step="1" min="0" onchange="calculateItemTotal(this)"></td>
                    <td><input type="text" class="unit-price" onchange="calculateItemTotal(this)" placeholder="$0.00"></td>
                    <td><input type="text" class="item-total" style="background: #f5f5f5; font-weight: bold;" placeholder="$0.00"></td>
                </tr>
                <tr>
                    <td><input type="text" class="country-origin"></td>
                    <td><textarea class="item-description" rows="1"></textarea></td>
                    <td><input type="text" class="hts-code"></td>
                    <td><input type="number" class="unit-qty" step="1" min="0" onchange="calculateItemTotal(this)"></td>
                    <td><input type="text" class="unit-price" onchange="calculateItemTotal(this)" placeholder="$0.00"></td>
                    <td><input type="text" class="item-total" style="background: #f5f5f5; font-weight: bold;" placeholder="$0.00"></td>
                </tr>
            </tbody>
            <tfoot>
                <tr class="total-row">
                    <td colspan="5" style="text-align: right; font-weight: bold; padding: 5px;">INVOICE TOTAL</td>
                    <td><input type="text" id="grandTotal" style="background: #e8e8e8; font-weight: bold;" placeholder="$0.00"></td>
                </tr>
                <tr>
                    <td colspan="6" style="padding: 5px;">
                        <strong style="font-size: 8px;">ABOVE PRICES INCLUDE:</strong>
                        <div class="checkbox-group" style="margin-top: 3px;">
                            <label><input type="checkbox" id="includesDuty"> DUTY</label>
                            <label><input type="checkbox" id="includesBrokerage"> BROKERAGE</label>
                            <label><input type="checkbox" id="includesFreight"> FREIGHT</label>
                        </div>
                    </td>
                </tr>
            </tfoot>
        </table>
        
        <!-- Declaration -->
        <table>
            <tr>
                <td colspan="5" style="padding: 8px;">
                    <p style="margin-bottom: 6px; font-size: 8px; font-weight: bold;">DECLARATION BY FOREIGN SHIPPER (To be completed only when the goods described above are of U.S. origin and their value exceeds $500.00)</p>
                    <p style="margin-bottom: 6px; line-height: 1.4; font-size: 8px;">I declare that the articles herein specified are to the best of my knowledge and belief, the growth, produce or manufacture of the United States: That they were exported from the United States from the port of 
                    <input type="text" id="usPort" style="width: 110px; border-bottom: 1px solid #000; display: inline;">
                    on or about 
                    <span style="display: inline-block; width: 110px; border-bottom: 1px solid #000;">&nbsp;</span>
                    that they are returned without having been advanced in value or improved in condition by any process of manufacture or other means. Any shipment that contains U.S. goods returned valued over $2,000 should have a manufacturer's affidavit attached to this invoice.</p>
                    <p style="margin-top: 10px; font-size: 8px;">
                        <strong>SHIPPER SIGNATURE</strong> 
                        <span style="display: inline-block; width: 160px; border-bottom: 1px solid #000; margin: 0 10px;"></span>
                        <strong>DATE SIGNED:</strong> 
                        <input type="date" id="signatureDate" style="width: 110px; border-bottom: 1px solid #000; display: inline; margin-left: 5px;">
                    </p>
                </td>
            </tr>
        </table>
        
        <!-- Final Certification -->
        <table>
            <tr>
                <td style="width: 42%; padding: 6px;">
                    <p style="font-size: 7.5px; line-height: 1.4;">To the best of the knowledge and belief of the preparer this invoice is true and complete and discloses the true prices, values, quantities, rebates, drawbacks, fees, commissions, royalties and any goods or services provided to the seller either free or at a reduced cost.</p>
                </td>
                <td style="width: 29%; padding: 6px;">
                    <span class="label">Preparer (if other than exporter)</span>
                    <input type="text" id="preparerName">
                </td>
                <td style="width: 29%; padding: 6px;">
                    <span class="label">Name of Responsible Employee of Exporter</span>
                    <input type="text" id="responsibleEmployee">
                </td>
            </tr>
        </table>
        
        <div style="display: flex; justify-content: space-between; font-size: 8px; margin: 15px 0 25px 0; padding-top: 10px; color: #999; page-break-inside: avoid;">
            <span>L 10 EX</span>
            <span>3/11</span>
        </div>
        
        <center style="margin-top: 10px;" class="print-btn">
            <button style="background-color: #2196F3; color: white; padding: 8px 20px; border: none; border-radius: 3px; cursor: pointer; font-size: 11px; font-weight: bold;" onclick="window.print()">Print / Save as PDF</button>
        </center>
        
    </div>
    
    <script>
        // Date auto-fill DISABLED - dates will be set by backend or user can enter manually
        // const today = new Date().toISOString().split('T')[0];
        // document.getElementById('invoiceDate').value = today;
        // document.getElementById('saleDate').value = today;
        
        // Toggle custom terms input when "Other" is selected
        function toggleCustomTerms(select) {
            const customInput = document.getElementById('termsOfSaleCustom');
            if (select.value === 'other') {
                customInput.style.display = 'inline-block';
                customInput.focus();
            } else {
                customInput.style.display = 'none';
                customInput.value = '';
            }
        }
        
        function addItemRow() {
            const tbody = document.getElementById('itemsBody');
            const row = document.createElement('tr');
            row.innerHTML = `
                <td><input type="text" class="country-origin"></td>
                <td><textarea class="item-description" rows="1"></textarea></td>
                <td><input type="text" class="hts-code"></td>
                <td><input type="number" class="unit-qty" step="1" min="0" onchange="calculateItemTotal(this)"></td>
                <td><input type="text" class="unit-price" onchange="calculateItemTotal(this)" placeholder="$0.00"></td>
                <td><input type="text" class="item-total" style="background: #f5f5f5; font-weight: bold;" placeholder="$0.00"></td>
            `;
            tbody.appendChild(row);
            
            // Auto-expand the textarea in the new row
            const textarea = row.querySelector('textarea');
            if (textarea) {
                textarea.addEventListener('input', function() {
                    this.style.height = 'auto';
                    this.style.height = this.scrollHeight + 'px';
                });
            }
        }
        
        function calculateItemTotal(element) {
            const row = element.closest('tr');
            const qty = parseFloat(row.querySelector('.unit-qty').value) || 0;
            // Remove $ and commas from price input before parsing
            const priceText = row.querySelector('.unit-price').value || '';
            const price = parseFloat(priceText.replace(/[$,]/g, '')) || 0;
            const total = qty * price;
            // Format total with $ and commas
            row.querySelector('.item-total').value = '$' + total.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ',');
            updateGrandTotal();
        }
        
        function updateGrandTotal() {
            const itemTotals = document.querySelectorAll('.item-total');
            let grandTotal = 0;
            itemTotals.forEach(input => {
                // Remove $ and commas before parsing
                const value = parseFloat(input.value.replace(/[$,]/g, '')) || 0;
                grandTotal += value;
            });
            // Format grand total with $ and commas
            document.getElementById('grandTotal').value = '$' + grandTotal.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        }
        
        // Auto-expand textareas to fit content
        function autoExpand(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = textarea.scrollHeight + 'px';
        }
        
        // Apply auto-expand to all textareas
        document.addEventListener('DOMContentLoaded', function() {
            const textareas = document.querySelectorAll('textarea');
            textareas.forEach(textarea => {
                // Auto-expand on input
                textarea.addEventListener('input', function() {
                    autoExpand(this);
                });
                // Initial expand for pre-filled content
                autoExpand(textarea);
            });
        });
    </script>
</body>
</html>